/**
* @license
* backbone-orm 99xp
* ----------------------------------
* v0.1.0
*
* Copyright (c)2020 Bruno Foggia, 99xp.
* Distributed under MIT license
*
* https://backbone-orm.99xp.org
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("underscore"),require("backbone"),require("validate-99xp")):"function"==typeof define&&define.amd?define(["exports","underscore","backbone","validate-99xp"],t):t((e=e||self).BackboneORM={},e._,e.Backbone,e.v)}(this,function(e,t,r,i){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t,r=r&&r.hasOwnProperty("default")?r.default:r,i=i&&i.hasOwnProperty("default")?i.default:i;var n={},s={preinitialize(){this.setEntity()},setEntity(){var e=t.result(this,"entityDefinition")||n.error("Entity Definition not found"),r=this.getConnection();return this.entity=r.isDefined(e[0])?r.model(e[0]):r.define(e[0],e[1]||{},e[2]||{})},getConnection(){return t.result(this,"conn")||t.result(n,"conn")||n.error("Database connection not set")},sync(e,r,i){return r.trigger("request",e,r,i),this["sync"+t.ucFirst(e)](e,r,i)},syncRead(e,t,r){if(this.id){return this.entity.findByPk(this.id).then(e=>(e=>{r.success(e.dataValues)})(e)).catch(e=>(e=>{r.error(e)})(e))}},syncCreate(e,r,i){var n=t.omit(this.attributes,this.idAttribute);return this.entity.create(n).then(e=>(e=>{var t={};t[r.idAttribute]=e.null,i.success(t)})(e)).catch(e=>(e=>{var t=[];for(let r in e.errors)t.push(e.errors[r].message);i.error([t,e])})(e))},syncUpdate(e,r,i){var n=t.omit(this.attributes,this.idAttribute),s={where:t.pick(this.attributes,this.idAttribute)};return this.entity.update(n,s).then(e=>(e=>{i.success(e[0])})(e)).catch(e=>(e=>{var t=[];for(let r in e.errors)t.push(e.errors[r].message);i.error([t,e])})(e))},validations:(e,t)=>({}),validationErrors(e){this._res.status(400).send({title:"Dados inv√°lidos",errors:e})}};n.Model=r.Model.extend(t.extend(t.clone(i),s)),n.error=function(e){throw new Error(e)},e.default=n,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=backbone-orm-99xp.min.js.map
